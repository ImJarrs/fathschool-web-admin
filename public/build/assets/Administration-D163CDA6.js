import{_ as j}from"./AppLayout-D06oZWsy.js";import{P as R}from"./Pagination-DHbdUHOs.js";import{_ as B,N as C,r as l,c as T,o as d,w as m,a as p,b as t,t as n,l as U,m as h,H as f,i as E,e as c,F as y,j as b,s as x,g as k,f as w}from"./app-B4siR4nP.js";import"./index-DtyboiO1.js";import"./TopBarMenu-nQHiLmrq.js";import"./CheckCircleIcon-DRQ2Sg4c.js";import"./XMarkIcon-BWTnXq2K.js";import"./WarningToast-C-jPV3vQ.js";import"./UserIcon-C-1rgfXS.js";import"./PlusCircleIcon-BZ251gFF.js";import"./Bars3Icon-C3NvXC29.js";const M={components:{AppLayout:j,Pagination:R,NothingFound:C},props:{administrations:Object,administrationsAttendance:Array,dates:Array,departments:Array,filter_data:Object},data(){const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),1).toISOString().slice(0,10),o=new Date(s.getFullYear(),s.getMonth()+1,0).toISOString().slice(0,10);return{filter:w.useForm({keyword:this.filter_data.keyword??"",department:this.filter_data.department??"",start_date:this.filter_data.start_date??e,end_date:this.filter_data.end_date??o}),loading:!1,options2:[],export_data:w.useForm({type:"PDF",department:"all"})}},created(){this.options2.push({value:"",label:"All"});for(const[s,e]of Object.entries(this.departments))this.options2.push({value:e.slug,label:e.name})},setup(s){const e=k(s.administrationsAttendance||[]),o=k(s.dates||[]);return{administrationsAttendance:e,dates:o}},methods:{filterOption(s,e){return e.label.toLowerCase().indexOf(s.toLowerCase())>=0},exportSubmit(){let s={};this.filter.department!==""&&(s.departement=this.filter.department),x({url:this.route("all.administration.export"),method:"POST",data:{...this.export_data,...s},headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},responseType:"blob"}).then(e=>{var o=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=o,r.setAttribute("download","administration-report.xlsx"),document.body.appendChild(r),r.click()})},filterData(){this.loading=!0;const s={keyword:this.filter.keyword||null,department:this.filter.department||null,start_date:this.filter.start_date,end_date:this.filter.end_date};this.$inertia.get(this.route("report.administration"),s,{preserveScroll:!0,onFinish:e=>{this.loading=!1,this.administrationsAttendance=e.props.administrationsAttendance||this.administrationsAttendance,this.dates=e.props.dates||this.dates}})},exportAttendance(){var e;this.loading=!0;let s={start_date:this.filter.start_date,end_date:this.filter.end_date,type:"xlsx"};(e=this.filter.keyword)!=null&&e.trim()&&(s.keyword=this.filter.keyword.trim()),this.filter.department&&(s.department=this.filter.department),x({url:this.route("report.administration.export"),method:"POST",data:s,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},responseType:"blob"}).then(o=>{var r=window.URL.createObjectURL(new Blob([o.data])),i=document.createElement("a");i.href=r,i.setAttribute("download","administration_attendance_"+this.filter.start_date+"_"+this.filter.end_date+".xlsx"),document.body.appendChild(i),i.click()}).catch(o=>{console.error(o)}).finally(()=>{this.loading=!1})}}},V={class:"py-12"},P={class:"dark:text-gray-400 mb-0"},I={class:"mb-3 ml-0.5"},q={class:"flex items-center"},H={class:"ml-4 flex items-center"},K={for:"start_date",class:"mr-2"},X={class:"ml-4 flex items-center"},Y={for:"end_date",class:"mr-2"},z={type:"submit",class:"ml-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},G={class:"xl:col-span-2 bg-white dark:bg-gray-800 rounded-lg"},J={class:"flex justify-between items-center px-6 py-4"},Q={class:"text-gray-900 dark:text-gray-400 text-lg font-bold"},W={class:"overflow-x-auto shadow-md rounded-lg"},Z={class:"w-full text-sm text-center text-gray-700 dark:text-gray-300"},$={class:"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-200"},tt={rowspan:"2",class:"py-4 px-6"},et={rowspan:"2",class:"py-4 px-6"},st=["colspan"],at={class:"py-4 px-6 font-medium"},nt={class:"py-4 px-6 font-medium text-left"},ot={class:"py-4 px-6"},rt={class:"py-4 px-6 font-semibold"},it={class:"py-4 px-6 font-semibold"},dt={class:"py-4 px-6 font-semibold"},lt={class:"py-4 px-6 font-semibold"},pt={key:1},ct={colspan:"{{ 3 + dates.length + 4 }}",class:"text-center p-4"},mt={class:"flex justify-center"};function _t(s,e,o,r,i,_){const g=l("BreadcrumbLink"),v=l("Breadcrumb"),A=l("page-header"),L=l("global-button"),S=l("NothingFound"),F=l("pagination"),O=l("AppLayout");return d(),T(O,{title:s.__("Administration Report")},{default:m(()=>[p(v,null,{default:m(()=>[p(g,{href:s.route("reports.index"),title:"Report"},null,8,["href"]),p(g,{title:s.__("Administration")},null,8,["title"])]),_:1}),t("div",V,[p(A,{class:"flex justify-between items-center"},{default:m(()=>[t("div",null,[t("h2",P,n(s.__("Administration Report")),1)])]),_:1}),t("div",I,[t("form",{onSubmit:e[3]||(e[3]=U((...a)=>_.filterData&&_.filterData(...a),["prevent"]))},[t("div",q,[h(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>i.filter.name=a),id:"name",placeholder:"Name",class:"p-2 border rounded"},null,512),[[f,i.filter.name]]),t("div",H,[t("label",K,n(s.__("From"))+":",1),h(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>i.filter.start_date=a),id:"start_date",class:"p-2 border rounded"},null,512),[[f,i.filter.start_date]])]),t("div",X,[t("label",Y,n(s.__("To"))+":",1),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>i.filter.end_date=a),id:"end_date",class:"p-2 border rounded mr-4"},null,512),[[f,i.filter.end_date]])]),t("button",z,n(s.__("Filter")),1)])],32)]),t("div",G,[t("div",J,[t("div",Q,n(s.__("Attendance List")),1),p(L,{loading:!1,onClick:_.exportAttendance,type:"button",theme:"sky"},{default:m(()=>[E(n(s.__("Export")),1)]),_:1},8,["onClick"])]),t("div",W,[t("table",Z,[t("thead",$,[t("tr",null,[e[4]||(e[4]=t("th",{rowspan:"2",class:"py-4 px-6"},"No",-1)),t("th",tt,n(s.__("Name")),1),t("th",et,n(s.__("Department")),1),t("th",{colspan:r.dates.length,class:"py-4 px-6"},n(s.__("Dates")),9,st),e[5]||(e[5]=t("th",{rowspan:"2",class:"py-4 px-6"},"Hadir",-1)),e[6]||(e[6]=t("th",{rowspan:"2",class:"py-4 px-6"},"Sakit",-1)),e[7]||(e[7]=t("th",{rowspan:"2",class:"py-4 px-6"},"Ijin",-1)),e[8]||(e[8]=t("th",{rowspan:"2",class:"py-4 px-6"},"Alfa",-1))]),t("tr",null,[(d(!0),c(y,null,b(r.dates,(a,u)=>(d(),c("th",{key:u,class:"py-3 px-5"},n(a),1))),128))])]),t("tbody",null,[r.administrationsAttendance.length>0?(d(!0),c(y,{key:0},b(r.administrationsAttendance,(a,u)=>(d(),c("tr",{key:a.id,class:"border-b border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600"},[t("td",at,n(u+1),1),t("td",nt,n(a.user_name),1),t("td",ot,n(a.department),1),(d(!0),c(y,null,b(a.attendance,(D,N)=>(d(),c("td",{key:N,class:"py-4 px-6"},n(D||"-"),1))),128)),t("td",rt,n(a.summary.hadir),1),t("td",it,n(a.summary.sakit),1),t("td",dt,n(a.summary.ijin),1),t("td",lt,n(a.summary.alfa),1)]))),128)):(d(),c("tr",pt,[t("td",ct,[p(S,{asShow:"div"})])]))])])])]),t("div",mt,[p(F,{class:"mt-6",links:o.administrations.links},null,8,["links"])])])]),_:1},8,["title"])}const Lt=B(M,[["render",_t],["__scopeId","data-v-5a8c141a"]]);export{Lt as default};
