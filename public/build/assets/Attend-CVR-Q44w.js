import{_ as A}from"./AppLayout-pRkTteQX.js";import{T as C}from"./ToolTip-BDAKiZ28.js";import{P as E}from"./Pagination-BOIqYq_w.js";import{_ as D,N,k as c,r as d,c as F,o as _,w as u,a,b as s,e as y,t as i,l as I,i as p,h as L,F as B,j as U,n as P,m as v,p as k,f as R}from"./app-R3TKzMFz.js";import{P as T}from"./PieChart-DPsnqrcO.js";import{_ as O}from"./Modal-BLSUD_Cv.js";import{s as z}from"./multiselect-S7NpFuS0.js";/* empty css                                                         */import{r as q}from"./ArrowRightIcon-BT0ViTrh.js";import{r as H}from"./EyeIcon-CK2ADUCC.js";import{r as G}from"./PencilSquareIcon-CBvao7ks.js";import{r as J}from"./TrashIcon-bv6UB_hV.js";import"./index-KXBnMdcv.js";import"./TopBarMenu-CcNsgK0k.js";import"./CheckCircleIcon-B4BTDw9l.js";import"./XMarkIcon-8_3jvOSV.js";import"./WarningToast-B-mvdry_.js";import"./UserIcon-CI54yQqe.js";import"./PlusCircleIcon-GzopV6YD.js";import"./Bars3Icon-BbGKyUny.js";import"./auto-CkVXdHX2.js";const K={components:{AppLayout:A,ToolTip:C,TrashIcon:J,PencilSquareIcon:G,Pagination:E,EyeIcon:H,ArrowRightIcon:q,dayjs:c,PieChart:T,ExportModal:O,Multiselect:z,NothingFound:N},props:{courses:Array,subjects:Array,students:Array,filter_data:Object,attendances:Object},data(){return{filter:R.useForm({course_id:this.filter_data.course_id??"",subject_id:this.filter_data.subject_id??"",student_id:this.filter_data.student_id??"",month:this.filter_data.month??"",year:this.filter_data.year??""}),customDateFormat:"YYYY-MM-DD",customMonthFormat:"YYYY-MM",month_value:this.filter_data.month?c(c(this.filter_data.month).format("MMM")+this.filter_data.year,this.customMonthFormat):null,subjects:this.subjects,students:this.students,selected_month:this.filter_data.month,selected_year:this.filter_data.year,visible:!1,loading:!1,export_data:{type:"xlsx",student:"",month:"",year:"",subject:"",course:""}}},watch:{month_value:function(e){e?(this.filter.month=c(e).format("MM"),this.filter.year=c(e).format("YYYY")):(this.filter.month=null,this.filter.year=null)},"filter.course_id":function(e,o){e&&this.filterData()}},methods:{filterData(){this.filter.get(this.route("report.attendance"))},showExportModal(){this.visible=!0},exportSubmit(){this.loading=!0,this.export_data.student=this.filter.student_id,this.export_data.year=this.filter.year,this.export_data.month=this.filter.month,this.export_data.subject=this.filter.subject,this.export_data.course=this.filter.course,axios({url:this.route("report.attendance.export"),method:"POST",data:this.export_data,responseType:"blob"}).then(e=>{this.export_data.type;var o=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=o;const m=e.headers["content-disposition"],r=m.indexOf('"')+1,l=m.lastIndexOf('"'),b=m.substring(r,l);n.setAttribute("download",b),document.body.appendChild(n),n.click(),this.loading=!1,this.visible=!1}).catch(e=>{this.loading=!1,this.visible=!1})},attendanceStatus(e,o){const n=e<10?`0${e}`:e,m=`${this.selected_year}-${this.selected_month}-${n}`;let r=null;return this.attendances.forEach(l=>{l.date==m&&(r=l.status)}),r},getMonthName(e){return c(`${this.selected_year}-${e}`).format("MMMM")}},computed:{daysInMonth(){return this.selected_year==""||this.selected_month==""?!1:c(`${this.selected_year}-${this.selected_month}`).daysInMonth()}},mounted(){}},Q={class:"py-12"},W={class:"mb-3 rounded-lg py-4 font-semibold text-left rtl:text-right text-gray-900 bg-white dark:text-white dark:bg-gray-800"},X={class:"dark:text-gray-400 mb-0 text-2xl"},Z={class:"col-span-2"},$={class:"col-span-2"},ee={class:"col-span-2"},te={class:"col-span-2"},se={class:"flex gap-3"},oe={class:"col-span-1"},re={key:0},ae={class:"bg-white dark:bg-gray-800 rounded-sm"},le={class:"flex justify-between items-center"},ne={class:"mb-0 text-black/[0.85] dark:text-gray-400 font-semibold text-base px-6 py-4"},ie={class:"mr-1"},de={class:"grid grid-cols-8 gap-3 p-4"},ue={class:"mb-1 text-xl font-medium mt-6"},ce={class:"text-md capitalize"},me={key:1,class:"text-center mt-52"},fe={class:"mt-2 text-sm font-medium text-gray-900"},pe={class:"mt-1 text-sm text-gray-500"},he={class:"flex gap-6"},_e={class:"w-full rounded-lg cursor-pointer flex items-center pl-4 border border-gray-200 dark:border-gray-700"},be={for:"pdf",class:"w-full cursor-pointer rounded-lg flex items-center pl-4 border border-gray-200 dark:border-gray-700"};function ge(e,o,n,m,r,l){const b=d("BreadcrumbLink"),w=d("Breadcrumb"),M=d("page-header"),f=d("global-label"),x=d("Multiselect"),j=d("a-date-picker"),g=d("global-button"),S=d("NothingFound"),V=d("export-modal"),Y=d("AppLayout");return _(),F(Y,{title:e.__("Attendance Report")},{default:u(()=>[a(w,null,{default:u(()=>[a(b,{href:e.route("reports.index"),title:"Report"},null,8,["href"]),a(b,{title:e.__("Attendance List")},null,8,["title"])]),_:1}),s("div",Q,[s("div",W,[a(M,{class:"flex justify-between items-center"},{default:u(()=>[s("div",null,[s("h1",X,i(e.__("Student Attendance")),1)])]),_:1}),s("form",{class:"grid grid-cols-1 md:grid-cols-9 gap-2 items-center px-6",onSubmit:o[4]||(o[4]=I(t=>l.filterData(),["prevent"]))},[s("div",Z,[a(f,{for:"class",value:"Course"}),a(x,{id:"class",class:"dark:text-gray-900",modelValue:r.filter.course_id,"onUpdate:modelValue":o[0]||(o[0]=t=>r.filter.course_id=t),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Course"),options:n.courses.map(t=>({value:t.id,label:t.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",$,[a(f,{for:"subject",value:"Subject"}),a(x,{id:"subject",class:"dark:text-gray-900",modelValue:r.filter.subject_id,"onUpdate:modelValue":o[1]||(o[1]=t=>r.filter.subject_id=t),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Subjects"),options:r.subjects.map(t=>({value:t.id,label:t.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",ee,[a(f,{for:"student",value:"Student"}),a(x,{id:"student",class:"dark:text-gray-900",modelValue:r.filter.student_id,"onUpdate:modelValue":o[2]||(o[2]=t=>r.filter.student_id=t),"close-on-select":!0,"can-clear":!1,searchable:!0,"create-option":!1,placeholder:e.__("Select Student"),options:r.students.map(t=>({value:t.id,label:t.name})),autocomplete:"off"},null,8,["modelValue","placeholder","options"])]),s("div",te,[a(f,{for:"month",value:"Month"}),s("div",se,[a(j,{size:"large",placeholder:e.__("Select Month"),picker:"month",value:r.month_value,"onUpdate:value":o[3]||(o[3]=t=>r.month_value=t),format:"MMM YYYY",style:{width:"400px"}},null,8,["placeholder","value"])])]),s("div",oe,[a(g,{loading:r.filter.processing,class:"text-white mt-6 bg-blue-500 dark:bg-blue-500 hover:bg-blue-500 active:bg-blue-600 dark:active:bg-blue-600 focus:border-blue-600 dark:focus:border-blue-600 focus:ring focus:ring-blue-300 dark:focus:ring-blue-300"},{default:u(()=>[p(i(e.__("Apply Filter")),1)]),_:1},8,["loading"])])],32)]),n.attendances.length&&r.selected_month&&r.selected_year?(_(),y("div",re,[s("div",ae,[s("div",le,[s("h2",ne,[s("span",null,[p(i(e.__("Attendance Sheet of"))+" ",1),s("b",ie,i(l.getMonthName(r.selected_month))+" "+i(r.selected_year),1)]),s("span",null,i(e.__("Attendance Sheet")),1)]),a(g,{onClick:o[5]||(o[5]=t=>l.showExportModal()),loading:!1,type:"button",class:"text-white bg-blue-500 dark:bg-blue-500 hover:bg-blue-500 active:bg-blue-600 dark:active:bg-blue-600 focus:border-blue-600 dark:focus:border-blue-600 focus:ring focus:ring-blue-300 dark:focus:ring-blue-300 mr-6"},{default:u(()=>[p(i(e.__("Export")),1)]),_:1})]),o[11]||(o[11]=s("hr",{class:"dark:border-gray-600"},null,-1)),s("div",de,[l.daysInMonth&&r.selected_month&&r.selected_year?(_(!0),y(B,{key:0},U(l.daysInMonth,(t,h)=>(_(),y("div",{key:h},[s("div",{class:P(["flex flex-col items-center pb-10 w-full max-w-sm border border-gray-200 rounded-lg shadow-md dark:border-gray-700 dark:text-black",l.attendanceStatus(t,n.attendances[h])=="present"?"bg-green-200 dark:bg-green-200":l.attendanceStatus(t,n.attendances[h])=="absent"?"bg-red-200 dark:bg-red-200":l.attendanceStatus(t,n.attendances[h])=="late"?"bg-yellow-200 dark:bg-yellow-200":"bg-gray-200 dark:bg-gray-200"])},[s("h5",ue,i(t),1),s("span",ce,i(l.attendanceStatus(t,n.attendances[h+1])??"Not Entry"),1)],2)]))),128)):L("",!0)])])])):(_(),y("div",me,[o[12]||(o[12]=s("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[s("path",{"vector-effect":"non-scaling-stroke","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"})],-1)),s("h3",fe,[a(S,{asShow:"div"})]),s("p",pe,i(e.__("Please choose the month, student, class, and subject")),1)]))]),a(V,{show:r.visible,onClose:o[10]||(o[10]=t=>r.visible=!1)},{title:u(()=>[p(i(e.__("Export Data")),1)]),content:u(()=>[s("div",he,[s("div",_e,[v(s("input",{value:"xlsx",id:"excel","onUpdate:modelValue":o[6]||(o[6]=t=>r.export_data.type=t),type:"radio",name:"export_type",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,r.export_data.type]]),a(f,{for:"excel",class:"py-3 ml-2 cursor-pointer w-full text-sm font-medium text-gray-900 dark:text-gray-300",value:"Excel",required:!1})]),s("label",be,[v(s("input",{value:"pdf",id:"pdf","onUpdate:modelValue":o[7]||(o[7]=t=>r.export_data.type=t),type:"radio",name:"export_type",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[k,r.export_data.type]]),a(f,{for:"pdf",class:"py-3 ml-2 w-full text-sm font-medium cursor-pointer text-gray-900 dark:text-gray-300",value:"PDF",required:!1})])])]),footer:u(()=>[a(g,{loading:!1,onClick:o[8]||(o[8]=t=>r.visible=!1),type:"button",theme:"outline-danger"},{default:u(()=>[p(i(e.__("Cancel")),1)]),_:1}),a(g,{onClick:o[9]||(o[9]=t=>l.exportSubmit()),loading:r.loading,type:"button",class:"mr-2"},{default:u(()=>[p(i(e.__("Export")),1)]),_:1},8,["loading"])]),_:1},8,["show"])]),_:1},8,["title"])}const Re=D(K,[["render",ge]]);export{Re as default};
